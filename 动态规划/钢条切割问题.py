def RodCutting(p, n):
    """
    钢条切割问题：给定价格表p，求长度为n的钢条的最大收益
    
    参数:
        p: 价格列表，p[i]表示长度为i的钢条的价格（p[0]不使用，i从1开始）
        n: 钢条的总长度
    
    返回:
        rec: 记录数组，rec[j]表示长度为j的钢条第一段应切割的长度
        C: DP数组，C[j]表示长度为j的钢条能获得的最大收益
    """
    # ------------------------------------------------------------------
    # 阶段1: 初始化DP数组和记录数组
    # ------------------------------------------------------------------
    # C[j] 表示长度为j的钢条能获得的最大收益
    # 长度为0时收益为0，所以C[0] = 0
    C = [0] * (n + 1)
    
    # rec[j] 记录达到最大收益C[j]时，第一段切割的长度
    # 初始值设为j（不切分，整体出售）
    rec = [0] * (n + 1)
    
    # ------------------------------------------------------------------
    # 阶段2: 动态规划求解（自底向上）
    # ------------------------------------------------------------------
    # 遍历所有可能的钢条长度j（从1到n）
    for j in range(1, n + 1):
        
        # 初始情况：不切分，整体出售长度为j的钢条
        q = p[j]  # 直接出售的收益
        rec[j] = j  # 记录第一段切割长度为j（不切分）
        
        # 遍历所有可能的第一段切割长度i（从1到j-1）
        # 尝试将长度为j的钢条切分为i和j-i两部分
        for i in range(1, j):
            
            # 如果切分后的收益更大，则更新最优解
            # p[i]是左半部分的收益，C[j-i]是右半部分的最大收益
            if q < p[i] + C[j - i]:
                q = p[i] + C[j - i]  # 更新最大收益
                rec[j] = i  # 记录第一段切割长度为i
        
        # 保存长度为j时的最大收益
        C[j] = q
    
    # ------------------------------------------------------------------
    # 阶段3: 返回结果
    # ------------------------------------------------------------------
    return rec, C


def Print_RodCutting(rec, n):
    """
    根据记录数组rec，打印长度为n的钢条的最优切割方案
    
    参数:
        rec: 记录数组，来自RodCutting函数
        n: 钢条的总长度
    """
    # ------------------------------------------------------------------
    # 阶段4: 回溯并打印切割方案
    # ------------------------------------------------------------------
    # 当还有剩余长度时继续切割
    parts = []  # 存储切割出的每一段长度
    while n > 0:
        # rec[n]给出当前钢条第一段应切割的长度
        parts.append(rec[n])
        n = n - rec[n]  # 剩余长度
    
    # 打印详细的切割方案
    print("切割方案:", " + ".join(map(str, parts)))
    return parts


# ------------------------------------------------------------------
# 主程序测试
# ------------------------------------------------------------------
if __name__ == "__main__":
    # 价格表：p[i]表示长度为i的钢条的价格
    # p[0]不使用，索引从1开始对应钢条长度
    p = [0, 1, 5, 8, 9, 10, 17, 17, 20, 24, 24]  # 长度为0到10的价格
    
    # 钢条总长度
    n = 10
    
    # 计算最优解
    rec, C = RodCutting(p, n)
    
    # 打印结果
    print("=" * 50)
    print(f"钢条长度: {n}")
    print(f"价格表: {p[1:]}")  # 跳过p[0]
    print("=" * 50)
    print("DP数组C（最大收益）:", C)
    print("记录数组rec（第一段切多长）:", rec)
    print("=" * 50)
    print("最优切割方案:")
    parts = Print_RodCutting(rec, n)
    
    # 验证收益
    total_revenue = sum(p[length] for length in parts)
    print(f"总收益: {total_revenue}（验证C[{n}] = {C[n]}）")